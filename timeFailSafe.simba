{$I WaspLib/osrs.simba}

var

  xpTimer: TStopWatch;

  xp: Integer;

procedure xpFailSafe();
begin
  Sleep(1000);
  xp := XPBar.Read();

  if XPBar.WaitXP(600) then
     xpTimer.Reset();

  if xpTimer.Elapsed >= 1 * 60 * 1000 then
  begin
    Logout.Open();

    TerminateScript("Reason: No xp gained in the last 10 minutes");
  end;
end;

begin
  Map.Setup([ERSChunk.VARROCK]);


  xpTimer.Start();
  while true do
  begin
    xpFailSafe();
  end;

end.
